<!-- Manhattan Distance: Player Starting Positions -->

<style>
  /* Mobile styling for Manhattan Distance slides */
  @media only screen and (max-width: 768px) {
    /* Comprehensive text size reduction for all Manhattan slides */
    section h2 {
      font-size: 0.55em !important;
    }

    section h3 {
      font-size: 0.48em !important;
    }

    section p {
      font-size: 0.42em !important;
      line-height: 1.3 !important;
    }

    section p strong {
      font-size: inherit !important;
    }

    section ul li {
      font-size: 0.4em !important;
      line-height: 1.3 !important;
    }

    section table {
      font-size: 0.35em !important;
    }

    section table th,
    section table td {
      padding: 4px !important;
      font-size: inherit !important;
    }

    /* Formula boxes */
    section div[style*="background: #e3f2fd"] {
      padding: 8px !important;
      margin: 8px 0 !important;
    }

    section div[style*="background: #e3f2fd"] p {
      font-size: 0.5em !important;
      white-space: nowrap !important;
      overflow-x: auto !important;
      -webkit-overflow-scrolling: touch !important;
    }

    section div[style*="background: #e3f2fd"] p:first-child {
      font-size: 0.6em !important;
      font-family: 'Georgia', serif !important;
      font-weight: bold !important;
    }

    section div[style*="background: #e3f2fd"] p:last-child {
      font-size: 0.48em !important;
    }

    /* Other colored boxes */
    section div[style*="background: #ecf0f1"],
    section div[style*="background: #f5f5f5"],
    section div[style*="background: #fff3cd"],
    section div[style*="background: #2ecc71"],
    section div[style*="background: #f3e5f5"] {
      padding: 6px !important;
      margin: 6px 0 !important;
      font-size: 0.4em !important;
    }

    section div[style*="background: #ecf0f1"] p,
    section div[style*="background: #f5f5f5"] p,
    section div[style*="background: #fff3cd"] p,
    section div[style*="background: #2ecc71"] p,
    section div[style*="background: #f3e5f5"] p {
      font-size: inherit !important;
    }

    /* SVG containers */
    section svg {
      max-width: 100% !important;
      height: auto !important;
    }

    /* SVG text elements */
    section svg text {
      font-size: 9px !important;
    }

    /* Heatmap layout - stack vertically on mobile */
    section.interactive-slide div[style*="display: flex"] {
      flex-direction: column !important;
      height: auto !important;
      padding: 10px !important;
    }

    section.interactive-slide div[style*="flex: 0 0 50%"],
    section.interactive-slide div[style*="flex: 1"] {
      flex: 1 1 100% !important;
      width: 100% !important;
      padding: 0 !important;
      margin-bottom: 15px !important;
    }

    section.interactive-slide div[id*="heatmap"] {
      min-height: 400px !important;
    }

    section.interactive-slide div[id*="dendrogram"] {
      min-height: 200px !important;
    }
  }

  @media only screen and (max-width: 480px) {
    section h2 {
      font-size: 0.48em !important;
    }

    section h3 {
      font-size: 0.42em !important;
    }

    section p {
      font-size: 0.38em !important;
    }

    section ul li {
      font-size: 0.36em !important;
    }

    section table {
      font-size: 0.32em !important;
    }

    section svg text {
      font-size: 7px !important;
    }
  }
</style>

<!-- Slide 1: Minimal Example - 2 Players, Average Starting Positions -->
<section>
  <h2>Manhattan Distance: Player Starting Positions</h2>
  <p><strong>Question:</strong> How different are two players' average starting positions, measured along grid lines?</p>

  <div class="two-columns" style="margin-top: 20px;">
    <div class="column">
      <h3>Example: Rodri vs Foden (Avg. Position)</h3>
      <table style="font-size: 0.8em; margin-top: 10px;">
        <tr><th>Player</th><th>X (yards)</th><th>Y (yards)</th></tr>
        <tr><td>Rodri</td><td>40</td><td>50</td></tr>
        <tr><td>Foden</td><td>70</td><td>30</td></tr>
      </table>

      <p style="margin-top: 15px; font-size: 0.85em;">
        <strong>Manhattan Distance:</strong> Sum of absolute differences (city block distance)
      </p>
      <p style="font-size: 0.8em; font-family: monospace; background: #f0f0f0; padding: 10px;">
        d = |70-40| + |30-50|<br/>
        d = 30 + 20<br/>
        d = <strong>50 yards</strong>
      </p>

      <p style="font-size: 0.75em; color: #666; margin-top: 10px;">
        <em>Named after Manhattan's grid street layout - you can only move along blocks, not diagonally!</em>
      </p>
    </div>

    <div class="column">
      <svg width="400" height="350" style="border: 1px solid #ddd; background: #f9f9f9;">
        <!-- Grid background -->
        <defs>
          <pattern id="grid-manhattan" width="20" height="20" patternUnits="userSpaceOnUse">
            <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e0e0e0" stroke-width="0.5"/>
          </pattern>
          <marker id="arrowblue-man" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
            <path d="M0,0 L0,6 L9,3 z" fill="#3498db" />
          </marker>
          <marker id="arrowgreen-man" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
            <path d="M0,0 L0,6 L9,3 z" fill="#2ecc71" />
          </marker>
        </defs>

        <!-- Football pitch representation with grid -->
        <rect x="50" y="50" width="300" height="250" fill="#90EE90" opacity="0.2" stroke="#888" stroke-width="1"/>
        <rect x="50" y="50" width="300" height="250" fill="url(#grid-manhattan)"/>

        <!-- Grid lines -->
        <line x1="50" y1="175" x2="350" y2="175" stroke="#ccc" stroke-width="1" stroke-dasharray="5,5"/>
        <line x1="200" y1="50" x2="200" y2="300" stroke="#ccc" stroke-width="1" stroke-dasharray="5,5"/>

        <!-- Axes -->
        <line x1="50" y1="300" x2="350" y2="300" stroke="#3498db" stroke-width="2" marker-end="url(#arrowblue-man)"/>
        <text x="320" y="320" fill="#3498db" font-size="13">X (width)</text>

        <line x1="50" y1="300" x2="50" y2="50" stroke="#2ecc71" stroke-width="2" marker-end="url(#arrowgreen-man)"/>
        <text x="10" y="70" fill="#2ecc71" font-size="13">Y (length)</text>

        <!-- Rodri point (40, 50) -> scaled to (140, 175) -->
        <circle cx="140" cy="175" r="8" fill="#e67e22" stroke="#000" stroke-width="2"/>
        <text x="145" y="170" font-size="13" font-weight="bold">Rodri</text>
        <text x="145" y="185" font-size="11">(40, 50)</text>

        <!-- Foden point (70, 30) -> scaled to (260, 245) -->
        <circle cx="260" cy="245" r="8" fill="#9b59b6" stroke="#000" stroke-width="2"/>
        <text x="220" y="265" font-size="13" font-weight="bold">Foden</text>
        <text x="220" y="280" font-size="11">(70, 30)</text>

        <!-- Manhattan path (horizontal then vertical) -->
        <line x1="140" y1="175" x2="260" y2="175" stroke="#e74c3c" stroke-width="4"/>
        <text x="190" y="165" font-size="12" font-weight="bold" fill="#e74c3c">30 yd</text>

        <line x1="260" y1="175" x2="260" y2="245" stroke="#e74c3c" stroke-width="4"/>
        <text x="270" y="210" font-size="12" font-weight="bold" fill="#e74c3c">20 yd</text>

        <!-- Alternative path (vertical then horizontal) shown as dashed -->
        <line x1="140" y1="175" x2="140" y2="245" stroke="#95a5a6" stroke-width="2" stroke-dasharray="5,5"/>
        <line x1="140" y1="245" x2="260" y2="245" stroke="#95a5a6" stroke-width="2" stroke-dasharray="5,5"/>

        <!-- Total distance label -->
        <text x="175" y="220" font-size="15" font-weight="bold" fill="#c0392b">Total: 50 yards</text>

        <!-- Axis labels -->
        <text x="135" y="315" font-size="10" fill="#666">40</text>
        <text x="255" y="315" font-size="10" fill="#666">70</text>
        <text x="30" y="180" font-size="10" fill="#666">50</text>
        <text x="30" y="250" font-size="10" fill="#666">30</text>
      </svg>
      <p style="font-size: 0.75em; color: #666; margin-top: 5px;">
        Red path shows one possible route. All grid paths have the same total distance!
      </p>
    </div>
  </div>
</section>

<!-- Slide 2: Formula and Computation -->
<section>
  <h2>Manhattan Distance: Step-by-Step Calculation</h2>

  <div style="font-size: 0.9em; max-width: 900px; margin: 0 auto;">
    <h3>The Formula</h3>
    <div style="background: #e3f2fd; border-left: 4px solid #2196f3; padding: 20px; margin: 15px 0;">
      <p style="font-size: 1.3em; font-family: 'Georgia', serif; text-align: center; margin: 0; font-weight: bold;">
        d(A, B) = |x‚ÇÇ-x‚ÇÅ| + |y‚ÇÇ-y‚ÇÅ|
      </p>
      <p style="font-size: 0.9em; text-align: center; margin: 10px 0 0 0; font-style: italic; color: #555;">
        Sum of absolute differences along each dimension
      </p>
    </div>

    <h3 style="margin-top: 20px;">Step 1: Calculate absolute differences for each dimension</h3>
    <table style="width: 100%; font-size: 0.85em; margin-top: 10px;">
      <tr style="background: #e67e22; color: white;">
        <th>Dimension</th><th>Rodri</th><th>Foden</th><th>Difference</th><th>Absolute Value</th>
      </tr>
      <tr>
        <td>X (width)</td><td>40</td><td>70</td><td>70 - 40 = 30</td><td>|30| = 30</td>
      </tr>
      <tr style="background: #ecf0f1;">
        <td>Y (length)</td><td>50</td><td>30</td><td>30 - 50 = -20</td><td>|-20| = 20</td>
      </tr>
    </table>

    <h3 style="margin-top: 20px;">Step 2: Sum the absolute differences (no squaring!)</h3>
    <p style="font-size: 1em; font-family: monospace; background: #2ecc71; color: white; padding: 10px;">
      d = 30 + 20 = <strong>50 yards</strong>
    </p>

    <h3 style="margin-top: 20px;">Comparison with Euclidean</h3>
    <table style="width: 100%; font-size: 0.8em; margin-top: 10px;">
      <tr style="background: #34495e; color: white;">
        <th>Metric</th><th>Formula on differences</th><th>Result</th>
      </tr>
      <tr>
        <td><strong>Manhattan</strong></td>
        <td>Sum absolute values: 30 + 20</td>
        <td><strong>50.0 yards</strong></td>
      </tr>
      <tr style="background: #ecf0f1;">
        <td>Euclidean</td>
        <td>Square, sum, sqrt: ‚àö(900 + 400)</td>
        <td>36.1 yards</td>
      </tr>
    </table>

    <p style="margin-top: 20px; font-size: 0.85em; color: #7f8c8d;">
      <strong>Key Difference:</strong> Manhattan is always ‚â• Euclidean. It's less sensitive to outliers because it doesn't square differences.
    </p>
  </div>
</section>

<!-- Slide 3: Scaling to Multiple Players -->
<section>
  <h2>Manhattan Distance: Multiple Players</h2>

  <div class="two-columns" style="font-size: 0.9em;">
    <div class="column">
      <h3>From 2 players to a whole team</h3>
      <ul style="font-size: 0.9em; line-height: 1.6;">
        <li><strong>2 players:</strong> 2-dimensional space (X, Y)</li>
        <li><strong>11 players:</strong> 22-dimensional space (X‚ÇÅ, Y‚ÇÅ, X‚ÇÇ, Y‚ÇÇ, ..., X‚ÇÅ‚ÇÅ, Y‚ÇÅ‚ÇÅ)</li>
        <li>Same formula, more dimensions</li>
        <li>Still measures grid-path distance</li>
      </ul>

      <div style="background: #ecf0f1; padding: 15px; margin-top: 15px;">
        <p style="font-family: monospace; font-size: 0.75em; margin: 0;">
          d = |x‚ÇÅ·¥¨-x‚ÇÅ·¥Æ| + |y‚ÇÅ·¥¨-y‚ÇÅ·¥Æ| + |x‚ÇÇ·¥¨-x‚ÇÇ·¥Æ| + ... + |y‚ÇÅ‚ÇÅ·¥¨-y‚ÇÅ‚ÇÅ·¥Æ|
        </p>
      </div>

      <h3 style="margin-top: 20px;">Example: Comparing Team Formations</h3>
      <p style="font-size: 0.85em;">
        4-3-3 vs 4-4-2 formations:<br/>
        <span style="font-family: monospace; background: #fff3cd; padding: 5px;">
          d = <strong>165.8 yards</strong>
        </span>
      </p>
    </div>

    <div class="column">
      <h3>When to Use Manhattan?</h3>
      <ul style="font-size: 0.85em; line-height: 1.6;">
        <li>‚úì Robust to outliers</li>
        <li>‚úì Interpretable: sum of differences</li>
        <li>‚úì Fast to compute (no squares/roots)</li>
        <li>‚úì Works well with high-dimensional data</li>
        <li>‚úì Natural for grid-based problems</li>
      </ul>

      <h3 style="margin-top: 20px;">Manhattan vs Euclidean</h3>
      <table style="font-size: 0.75em; width: 100%;">
        <tr style="background: #e67e22; color: white;">
          <th>Property</th><th>Manhattan</th><th>Euclidean</th>
        </tr>
        <tr>
          <td>Outlier sensitivity</td>
          <td style="background: #d5f4e6;">Low</td>
          <td style="background: #f8d7da;">High</td>
        </tr>
        <tr>
          <td>Computation</td>
          <td style="background: #d5f4e6;">Fast</td>
          <td>Moderate</td>
        </tr>
        <tr>
          <td>Distance value</td>
          <td>Larger</td>
          <td style="background: #d5f4e6;">Smaller</td>
        </tr>
        <tr>
          <td>Geometric meaning</td>
          <td>Grid path</td>
          <td style="background: #d5f4e6;">Straight line</td>
        </tr>
      </table>
    </div>
  </div>
</section>

<!-- Slide 4: Premier League Heatmap -->
<section class="interactive-slide">
  <div style="display: flex; gap: 20px; height: 100%; align-items: flex-start; padding: 20px;">
    <div style="flex: 0 0 50%; padding-right: 20px; text-align: left; display: flex; flex-direction: column;">
      <h2 style="font-size: 1.3em; margin-top: 0; text-align: left;">Manhattan Distance Heatmap</h2>
      <p style="font-size: 0.9em; line-height: 1.5; margin-top: 15px; text-align: left;">
        <strong>24 Premier League players</strong> clustered by their average starting positions on the pitch.
      </p>
      <p style="font-size: 0.85em; line-height: 1.5; margin-top: 15px; text-align: left;">
        Each cell shows the Manhattan distance (in yards) - the grid-based path between two players' positions.
      </p>
      <p style="font-size: 0.85em; line-height: 1.5; margin-top: 15px; text-align: left;">
        <strong>Key difference from Euclidean:</strong> Manhattan distance is always larger because it measures along grid lines, not straight-line paths.
      </p>
      <p style="font-size: 0.8em; margin-top: 20px; padding: 10px; background: #f3e5f5; border-radius: 5px; text-align: left;">
        üí° <strong>Tip:</strong> Click dendrogram branches to highlight player clusters
      </p>
      <div id="manhattan-heatmap-premier-dendrogram" style="width: 100%; flex: 1; min-height: 150px; margin-top: 20px;"></div>
    </div>
    <div style="flex: 1; display: flex; justify-content: center; align-items: center; min-height: 0;">
      <div id="manhattan-heatmap-premier" style="width: 100%; height: 100%;"></div>
    </div>
  </div>
</section>
